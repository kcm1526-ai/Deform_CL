# Configuration for Vessel Segmentation using UNet (baseline)
# Dataset: M3DVBAV_CropLung (CT/MRI lung vessel images)

MODEL:
  META_ARCHITECTURE: "VesselPatchSegmentor3d"
  OUT_CHANNELS: (24,)
  OUT_TASKS: ["features"]
  TASK: ['seg']  # Segmentation only (no centerline deformation)
  PRED_CLASS: 1  # Vessel class (can be adjusted based on your label values)
  BACKBONE:
    NAME: "build_unetaf_backbone"
  UNETENCODER:
    BASE_CHANNELS: 16
    NUM_LAYERS: 4
    NORM: 'SyncBN'
  SEGMENTOR:
    LOSS: "Diceloss"

DATASETS:
  TRAIN: ("VesselSeg",)
  TEST: ("VesselSeg",)
  NUM_FOLDS: 5
  TEST_FOLDS: (0,)

DATALOADER:
  NUM_WORKERS: 4

INPUT:
  CROP_SIZE_TRAIN: (128, 128, 128)  # Adjust based on your GPU memory

SOLVER:
  IMS_PER_BATCH: 2  # Adjust based on your GPU memory
  BASE_LR: 1e-3
  WEIGHT_DECAY: 1e-3
  WARMUP_ITERS: 250
  WARMUP_FACTOR: 0.3
  LR_SCHEDULER_NAME: "WarmupCosineLR"
  MAX_ITER: 10000  # Adjust based on your dataset size
  CHECKPOINT_PERIOD: 1000
  CLIP_GRADIENTS:
    ENABLED: True
    CLIP_TYPE: "full_model"
    CLIP_VALUE: 0.01
    NORM_TYPE: 2.0
  BACKBONE_MULTIPLIER: 1.0

TEST:
  EVAL_PERIOD: 1000

OUTPUT_DIR: "./outputs/vessel_unet"

CUDNN_BENCHMARK: False
